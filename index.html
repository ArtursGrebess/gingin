<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Menu Translator</title>
    <style>
      table {
        width: 100%;
        border-collapse: collapse;
      }
      th,
      td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }
      th {
        background-color: #f2f2f2;
      }
      #status {
        margin: 20px 0;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
      }
      #sheet-list {
        margin: 20px 0;
      }
    </style>
    <script>
      function fetchData() {
        const sheetId = "1do2TOAURvOoBi9pyodLmJBa3IbiVXzeJ6-96gHiAMF8"; // Your actual Sheet ID
        const apiKey = "aadd767be2022dcab4ec766cab8c65ff4af8a8f2"; // Your actual API Key

        document.getElementById("status").innerText = "Fetching data...";
        document.getElementById("sheet-data").innerHTML = "";
        document.getElementById("spreadsheet-name").innerText = "";
        document.getElementById("sheet-list").innerHTML = "";

        fetch(
          `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}?key=${apiKey}`
        )
          .then((response) => response.json())
          .then((data) => {
            const spreadsheetName = data.properties.title;
            const sheets = data.sheets.map((sheet) => sheet.properties.title);

            document.getElementById(
              "spreadsheet-name"
            ).innerText = `Spreadsheet: ${spreadsheetName}`;
            document.getElementById("sheet-list").innerHTML =
              "<strong>Sheets:</strong><ul>" +
              sheets.map((sheet) => `<li>${sheet}</li>`).join("") +
              "</ul>";

            const range = `${sheets[0]}!A1:H`; // Adjust the range as needed

            return fetch(
              `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`
            );
          })
          .then((response) => response.json())
          .then((data) => {
            const rows = data.values;
            let html = "<table>";
            if (rows && rows.length > 0) {
              // Add table headers
              html += "<tr>";
              rows[0].forEach((header) => {
                html += `<th>${header}</th>`;
              });
              html += "</tr>";
              // Add table rows
              rows.slice(1).forEach((row) => {
                html += "<tr>";
                row.forEach((cell) => {
                  html += `<td>${cell || ""}</td>`;
                });
                html += "</tr>";
              });
            }
            html += "</table>";
            document.getElementById("sheet-data").innerHTML = html;
            document.getElementById("status").innerText =
              "Data fetched successfully!";
          })
          .catch((error) => {
            console.error("Error fetching data:", error);
            document.getElementById("status").innerText = "Error fetching data";
          });
      }
    </script>
  </head>
  <body>
    <h1>Menu Translator</h1>
    <button onclick="fetchData()">Fetch Data</button>
    <div id="status"></div>
    <div id="spreadsheet-name"></div>
    <div id="sheet-list"></div>
    <div id="sheet-data"></div>
  </body>
</html>
